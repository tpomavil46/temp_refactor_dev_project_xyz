<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seeq Asset Tree Manager</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="icon" href="data:,">
</head>
<body>
    <div class="logo-container">
        <img src="/static/logo.png" alt="Company Logo" class="logo">
    </div>
    <h1>Seeq Asset Tree Manager</h1>
    <div id="main-container">
        <!-- Controls Section -->
        <div id="controls-section">
            <!-- Controls Toggle -->
            <div id="controls-toggle">
                <label for="control-selector">Select Controls:</label>
                <select id="control-selector">
                    <option value="asset-tree-controls">Asset Tree Controls</option>
                    <option value="lookup-controls">Lookup Workflow</option>
                </select>
            </div>

            <!-- Asset Tree Controls -->
            <div id="asset-tree-controls" class="section">
                <h2>Asset Tree Controls</h2>
                <div class="group">
                    <label for="tree-name">Tree Name:</label>
                    <input type="text" id="tree-name" placeholder="Enter tree name">
                    <label for="workbook-name">Workbook Name:</label>
                    <input type="text" id="workbook-name" placeholder="Enter workbook name">
                    
                    <div>
                        <label for="csv-file">Upload CSV File:</label>
                        <input type="file" id="csv-file" accept=".csv">
                        <button id="upload-csv">Upload</button>
                    </div>
                    
                    <button id="process-csv">Process CSV</button>
                    <button id="create-empty-tree">Create Empty Tree</button>
                    <button id="search-tree">Search for Tree</button>
                    <button id="clear-tree">Clear Tree</button>
                    <button id="openModifyDialog">Modify Tree</button>
                </div>
            </div>

            <!-- Lookup Workflow -->
            <div id="lookup-controls" class="section" style="display: none;">
                <h2>Lookup Workflow</h2>
                <div class="group">
                    <!-- Step 1: Upload Raw CSV -->
                     <!-- Tree & Workbook Name Inputs (Needed for Lookup Push) -->
                    <label for="tree-name">Tree Name:</label>
                    <input type="text" id="tree-name" placeholder="Enter tree name">

                    <label for="workbook-name">Workbook Name:</label>
                    <input type="text" id="workbook-name" placeholder="Enter workbook name">
                    <label for="raw-csv">Upload Raw CSV:</label>
                    <input type="file" id="raw-csv" name="raw-csv" accept=".csv">
                    <button id="upload-raw-csv">Upload</button>

                    <!-- Step 2: Handle Duplicates -->
                    <div id="duplicates-section" style="display: none;">
                        <h3>Handle Duplicates</h3>
                        <p id="duplicate-info">Duplicates detected. Select a resolution strategy:</p>
                        <label for="group-column">Group Column:</label>
                        <input type="text" id="group-column" placeholder="Enter Group Column (e.g., GroupName)">
                        <label for="key-column">Key Column:</label>
                        <input type="text" id="key-column" placeholder="Enter Key Column (e.g., Key)">
                        <label for="value-column">Value Column:</label>
                        <input type="text" id="value-column" placeholder="Enter Value Column (e.g., Value)">
                        <button id="resolve-duplicates">Resolve Duplicates</button>
                    </div>

                    <!-- Duplicate Rows Modal (Embedded in Lookup Workflow) -->
                    <div id="duplicates-modal" style="display: none;">
                        <h3>Resolve Duplicates</h3>
                        <p>Select rows to keep:</p>
                        <table id="duplicates-table" border="1">
                            <thead>
                                <tr id="duplicates-table-header">
                                    <!-- Column headers will be added dynamically -->
                                </tr>
                            </thead>
                            <tbody id="duplicates-table-body">
                                <!-- Duplicate rows will be added dynamically -->
                            </tbody>
                        </table>
                        <button id="submit-selected-rows">Submit Selection</button>
                    </div>

                    <!-- Step 3: Set Parent Paths -->
                    <!-- Parent Path Section -->
                    <div id="parent-path-section" style="display: none;">
                        <h3>Set Parent Paths</h3>
                        <p>Specify Parent Paths for each Lookup String:</p>
                        <div id="parent-paths-section">
                            <!-- Dynamic inputs for Parent Paths will be populated here -->
                        </div>
                        <button id="set-parent-paths">Set Parent Paths</button>
                    </div>

                    <!-- Step 4: Push Lookup -->
                    <div id="push-lookup-section" style="display: none;">
                        <h3>Push Lookup Table</h3>
                        <button id="push-lookup-btn">Push Lookup to Seeq</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Section -->
        <div id="visualization-section">
            <h2>Tree Visualization</h2>
            <div id="tree-visualization">
                <p class="placeholder-message">Tree visualization will appear here after processing the CSV or creating a tree.</p>
            </div>
        </div>
    </div>

    <!-- Modals (Hidden by Default) -->
    <!-- User-Specific Modal -->
    <div id="user-specific-modal" style="display: none;">
        <h3>Specify Rows to Keep</h3>
        <p>Enter comma-separated row indices (e.g., 1,3,5):</p>
        <input type="text" id="rows-to-keep-input" placeholder="E.g., 1,3,5">
        <button id="apply-user-specific">Apply</button>
    </div>

    <!-- Modify Tree Modal -->
    <div id="modifyDialog" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Modify Tree</h2>

            <label for="operation">Operation:</label>
            <select id="operation">
                <option value="insert">Insert</option>
                <option value="move">Move</option>
                <option value="remove">Remove</option>
            </select>

            <div id="insertFields">
                <label for="parentPath">Parent Path:</label>
                <input type="text" id="parentPath">
                
                <label for="name">Name:</label>
                <input type="text" id="name">

                <label for="formula">Formula:</label>
                <input type="text" id="formula">

                <label for="formulaParams">Formula Parameters:</label>
                <input type="text" id="formulaParams">
            </div>

            <div id="moveFields" style="display: none;">
                <label for="sourcePath">Source Path:</label>
                <input type="text" id="sourcePath">

                <label for="destinationPath">Destination Path:</label>
                <input type="text" id="destinationPath">
            </div>

            <div id="removeFields" style="display: none;">
                <label for="removeName">Name:</label>
                <input type="text" id="removeName">
            </div>

            <button id="submitModification">Submit</button>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>